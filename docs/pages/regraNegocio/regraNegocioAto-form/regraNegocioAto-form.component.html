<tce-breadcrumb [items]="[{text: 'Cadastro Regra de Negócio', link: '/dashboard/regranegocioato'}, {text: pageTitle}]">
</tce-breadcrumb>
<tce-server-error-messages [server-error-messages]="serverErrorMessages"></tce-server-error-messages>

<div class="card ">
  <div class="card-body">
    <div class="card-header">
      <strong>{{pageTitle}}</strong>
    </div>
    <div class="box section-block">
      <fieldset class="withBorder">
        <legend class="withBorder">Cadastro de Regras de Negócio: </legend>
        <form [formGroup]="resourceForm" (submit)="submitForm()" class="m-l-reset">
          <div class="row">
            <div class="form-group col-md-5">             
              <label for="descricaoRegraNegocioAto">Descrição da Regra de Negócio:</label>
                <div [ngClass]="getClass('descricaoRegraNegocioAto') ? 'form-group has-success' : 'form-group has-danger'">
                  <input type="text" class="form-control" id="descricaoRegraNegocioAto" autocomplete="off" formControlName="descricaoRegraNegocioAto"
                  placeholder="Descrição da Regra de Negócio">
                <app-form-field-error [form-control]="resourceForm.get('descricaoRegraNegocioAto')"></app-form-field-error>
                </div>
            </div>
            <div class="form-group col-md-5">
              <label for="descricaoMensagem">Mensagem de Retorno:</label>
                <div [ngClass]="getClass('descricaoMensagem') ? 'form-group has-success' : 'form-group has-danger'">
                  <input type="text" class="form-control" id="descricaoMensagem" autocomplete="off" formControlName="descricaoMensagem"
                  placeholder="Descrição da Mensagem de Retorno">
                  <app-form-field-error [form-control]="resourceForm.get('descricaoMensagem')"></app-form-field-error>
                </div>
            </div>            
          </div>  
          <div class="row">
            <div class="form-group col-md-5">
                <label for="idTipoAto">Tipo de Ato:</label>      
                <ng-select [items]="resTiposAtos" bindLabel="nomeTipoAto" bindValue="idTipoAto"
                  formControlName="idTipoAto" placeholder="Selecione o Tipo de Ato"
                  [ngClass]="{ 'is-invalid': resourceForm.errors }"></ng-select>
                <app-form-field-error [form-control]="resourceForm.get('idTipoAto')"></app-form-field-error>
            </div>
            <div class="form-group col-md-5">
              <label for="Sexo">Sexo:</label>
              <ng-select [items]="resSexo" required bindLabel="descricao" bindValue="sexo" 
                formControlName="sexo" placeholder="Selecione o Sexo"
                [ngClass]="{ 'is-invalid': resourceForm.errors }"></ng-select>                
              <app-form-field-error [form-control]="resourceForm.get('sexo')"></app-form-field-error>          
            </div>
          </div>
          <div class="row">
            <div class="form-group col-md-5">
              <label for="fundamento">Fundamentação Jurídica</label>
              <ng-select [items]="resFundamentacoesJuridicas" bindLabel="descricaoFundamentacaoJuridicaConcessao" bindValue="idFundamentacaoJuridicaConcessao"
                formControlName="idFundamentacaoJuridicaConcessao" placeholder="Selecione uma Fundamentação Jurídica" [(ngModel)]="idFundamentacaoJuridicaConcessaoEscolhida"
                [ngClass]="{ 'is-invalid': resourceForm.errors }" (change)="changeFundamentacaoJuridica()"></ng-select>
              <app-form-field-error [form-control]="resourceForm.get('idFundamentacaoJuridicaConcessao')"></app-form-field-error>
            </div>
            <div class="form-group col-md-1">
              <label for="acao">Ação</label>
              <button [disabled]="desabilitaBotaoAdicionarFundamentacaoJuridica" (click)="adicionarFundamentacaoJuridicaAsFundamentacoesJuridicasEscolhidas()" type="button" class="btn btn-default btn-circle form-control" title="Adicionar Fundamentação Jurídica">
                <i class="fa fa-plus"></i>
              </button>
            </div>          
            <div class="form-group col-md-5">
              <table class="table table-striped" *ngIf='resFundamentacoesJuridicasEscolhidas && resFundamentacoesJuridicasEscolhidas.length'>
                <thead class="thead-light">
                  <tr>
                    <th class="text-center">#</th>
                    <th class="text-center">Descrição da Fund. Jurídica</th>
                    <th class="text-center">Ação</th>
                  </tr>    
                </thead>
                <tbody>
                  <tr *ngFor="let res of resFundamentacoesJuridicasEscolhidas; index as i">
                    <td class="text-center">
                        <small>{{i+1}}</small>
                    </td>
                    <td>
                      <small>{{res.descricaoFundamentacaoJuridicaConcessao}}</small>
                    </td>
                    <td class="text-center">
                      <a (click)="removerFundamentacaoJuridicaEscolhida(res)" class="btn btn-outline-danger btn-sm mr-2 d-inline text-danger"><i class="fa fa-trash"></i></a>
                    </td>
                  </tr>
                </tbody>
              </table>
              <table class="table table-striped" *ngIf='resFundamentacoesJuridicasEscolhidas.length <=0'>
                <thead class="thead-light">
                  <tr>
                    <th class="text-center">#</th>
                    <th class="text-center">Descrição da Fund. Jurídica</th>
                    <th class="text-center">Ação</th>
                  </tr>    
                </thead>
                <tbody>
                  <tr>
                    <td class="text-center">
                      <small></small>
                    </td>
                    <td class="text-center">
                      <small>Nenhuma Fundamentação Jurídica adicionada</small>
                    </td>
                    <td class="text-center">
                      <small></small>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>            
          </div>
          <div class="row">
            <div class="form-group col-md-5">
              <label for="regraAto">Regra(s):</label>
              <ng-select [items]="resRegrasAtos" bindLabel="descricaoRegraAto" bindValue="idRegraAto"
                formControlName="idRegraAto" placeholder="Selecione uma Regra" [(ngModel)]="idRegraAtoEscolhida"
                [ngClass]="{ 'is-invalid': resourceForm.errors }" (change)="changeRegraAto()"></ng-select>
              <app-form-field-error [form-control]="resourceForm.get('idRegraAto')"></app-form-field-error>
            </div>
            <div class="form-group col-md-1">
              <label for="acao">Ação</label>
              <button [disabled]="desabilitaBotaoAdicionarRegraAto" (click)="adicionarRegraAtoAsRegrasAtosEscolhidas()" type="button" class="btn btn-default btn-circle form-control" title="Adicionar Regra">
                <i class="fa fa-plus"></i>
              </button>
            </div>          
            <div class="form-group col-md-5">
              <table class="table table-striped" *ngIf='resRegrasAtosEscolhidas && resRegrasAtosEscolhidas.length'>
                <thead class="thead-light">
                  <tr>
                    <th class="text-center">#</th>
                    <th class="text-center">Descrição da Regra</th>
                    <th class="text-center">Ação</th>
                  </tr>  
                </thead>
                <tbody>
                  <tr *ngFor="let res of resRegrasAtosEscolhidas; index as i">
                    <td class="text-center">
                        <small>{{i+1}}</small>
                    </td>
                    <td>
                      <small>{{res.descricaoRegraAto}}</small>
                    </td>
                    <td class="text-center">
                        <a (click)="removerRegraAtoEscolhida(res)" class="btn btn-outline-danger btn-sm mr-2 d-inline text-danger"><i class="fa fa-trash"></i></a>
                    </td>
                  </tr>
                </tbody>
              </table>
              <table class="table table-striped" *ngIf='resRegrasAtosEscolhidas.length <=0'>
                <thead class="thead-light">
                  <tr>
                    <th class="text-center">#</th>
                    <th class="text-center">Descrição da Regra</th>
                    <th class="text-center">Ação</th>
                  </tr>
    
                </thead>
                <tbody>
                  <tr>
                    <td class="text-center">
                        <small></small>
                    </td>
                    <td class="text-center">
                      <small>Nenhuma Regra adicionada</small>
                    </td>
                    <td class="text-center">
                      <small></small>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>            
          </div>
          <div class="row">
            <div class="form-group col-md-4">
                <label for="idOperadorLogico">Lógica de Aplicação das Regras:</label>      
                <ng-select [items]="resOperadoresLogicos" bindLabel="nomeOperadorLogico" bindValue="idOperadorLogico"
                  formControlName="idOperadorLogico" placeholder="Selecione o Operador Lógico"
                  [ngClass]="{ 'is-invalid': resourceForm.errors }"></ng-select>
                <app-form-field-error [form-control]="resourceForm.get('idOperadorLogico')"></app-form-field-error>
            </div>
          </div>   
          <div class="form-group col-md-10">
            <div class="form-group active pl-2">
              <input class="form-check-input ng-valid ng-dirty ng-touched" id="ativo" name="ativo" type="checkbox"
               ng-reflect-name="ativo" formControlName="ativo"> <label for="ativo">Ativo</label>
            </div>
          </div>      
          <tce-buttons [actions]="actions" [disabled]="resourceForm.invalid" [clear]="false"></tce-buttons>
        </form>
      </fieldset>
    </div>
  </div>
</div>